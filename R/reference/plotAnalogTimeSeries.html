<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>RAnEn::plotAnalogTimeSeries — plotAnalogTimeSeries • RAnEn</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="RAnEn::plotAnalogTimeSeries — plotAnalogTimeSeries" />
<meta property="og:description" content="RAnEn::plotAnalogTimeSeries plots forecasts and observations
for comparison over time." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RAnEn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Weiming-Hu/AnalogsEnsemble">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>RAnEn::plotAnalogTimeSeries</h1>
    <small class="dont-index">Source: <a href='https://github.com/Weiming-Hu/AnalogsEnsemble/blob/master/R/plotAnalogTimeSeries.R'><code>R/plotAnalogTimeSeries.R</code></a></small>
    <div class="hidden name"><code>plotAnalogTimeSeries.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>RAnEn::plotAnalogTimeSeries plots forecasts and observations
for comparison over time.</p>
    </div>

    <pre class="usage"><span class='fu'>plotAnalogTimeSeries</span>(
  <span class='no'>start.time</span>,
  <span class='no'>end.time</span>,
  <span class='no'>i.station</span>,
  <span class='no'>obs.id</span>,
  <span class='no'>obs.times</span>,
  <span class='no'>obs.data</span>,
  <span class='no'>anen.times</span>,
  <span class='no'>anen.flts</span>,
  <span class='no'>anen.data</span>,
  <span class='kw'>fcst.id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fcst.times</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fcst.flts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fcst.data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>max.flt</span> <span class='kw'>=</span> <span class='fl'>82800</span>,
  <span class='kw'>par.name</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>return.data</span> <span class='kw'>=</span> <span class='no'>F</span>,
  <span class='kw'>smooth</span> <span class='kw'>=</span> <span class='fl'>4</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>start.time</th>
      <td><p>A POSIXct for the start time.</p></td>
    </tr>
    <tr>
      <th>end.time</th>
      <td><p>A POSIXct for the end time.</p></td>
    </tr>
    <tr>
      <th>i.station</th>
      <td><p>The station index to visualize. This can
be a single scalar so that the same station index for
observations, AnEn, and forecasts is used; or it can be
a named vector like this:
<code>i.station = c('obs' = 4, 'anen' = 15, 'fcst' = 10)</code> or
<code>i.station = c('obs' = 4, 'anen' = 15)</code>.</p></td>
    </tr>
    <tr>
      <th>obs.id</th>
      <td><p>The observation parameter ID.</p></td>
    </tr>
    <tr>
      <th>obs.times</th>
      <td><p>A vector for observation times. Usually
this is <code>observations$Times</code>.</p></td>
    </tr>
    <tr>
      <th>obs.data</th>
      <td><p>An array for observation data. Usually
this is <code>observations$Data</code>.</p></td>
    </tr>
    <tr>
      <th>anen.times</th>
      <td><p>A vector for AnEn times. Usually
this is <code>config$test_time_compares</code>.</p></td>
    </tr>
    <tr>
      <th>anen.flts</th>
      <td><p>A vector for AnEn flts. Usually
this is <code>config$flts</code>.</p></td>
    </tr>
    <tr>
      <th>anen.data</th>
      <td><p>An array for AnEn data. Usually
this is <code>AnEn$analogs[, , , , 1]</code></p></td>
    </tr>
    <tr>
      <th>fcst.id</th>
      <td><p>The forecast parameter ID.</p></td>
    </tr>
    <tr>
      <th>fcst.times</th>
      <td><p>A vector for forecast times. Usually
this is <code>forecasts$Times</code>.</p></td>
    </tr>
    <tr>
      <th>fcst.flts</th>
      <td><p>A vector for forecast flts. Usually
this is <code>forecasts$flts</code>.</p></td>
    </tr>
    <tr>
      <th>fcst.data</th>
      <td><p>An array for forecast data. Usually
this is <code>forecasts$Data</code>.</p></td>
    </tr>
    <tr>
      <th>max.flt</th>
      <td><p>The cut off point value for both
forecasts and AnEn lead times.</p></td>
    </tr>
    <tr>
      <th>par.name</th>
      <td><p>The variable name to be shown on figures.</p></td>
    </tr>
    <tr>
      <th>return.data</th>
      <td><p>Whether to return the plot data
so that you can generate your own plots. This will
suppress plotting the figure inside this function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>return.data</code> is TRUE, a list with two
data frames is returned; otherwise, it returns a ggplot
object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Sometimes, it is helpful to plot forecasts and observations
for a long time series. However, this is always limited
by forecast lead times because the lead times are usually
for several days. What if we want to plot a time series that
spans longer than that?</p>
<p>This function generates a plot for that purpose. It simply
stacks forecasts from different days and all forecasts lead
times. Overlapping lead times will be cut off and earlier
lead times will be preferred and kept.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># If you have already generated AnEn by using the </span>
<span class='co'># function RAnEn::generateAnalogs, you probably already</span>
<span class='co'># have the followings or the equivalents:</span>
<span class='co'># </span>
<span class='co'># - observations (An observation list with members)</span>
<span class='co'># - config (The configuration used for AnEn generation)</span>
<span class='co'># - forecasts (A forecast list with members)</span>
<span class='co'># </span>
<span class='co'># Then you can run the following code</span>
<span class='co'># </span>

<span class='co'># Want to learn more about the configuration setup?</span>
<span class='co'># Please see [this tutorial](https://weiming-hu.github.io/AnalogsEnsemble/2018/11/04/demo-1-RAnEn-basics.html).</span>
<span class='co'># </span>
<span class='no'>file.name</span> <span class='kw'>&lt;-</span> <span class='st'>'data-NAM-StateCollege.RData'</span>

<span class='kw'>if</span> (!<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span>(<span class='no'>file.name</span>)) {
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='st'>'Downloading from the data server which might be slow ...\n'</span>)
  <span class='fu'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span>(<span class='kw'>url</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>'https://prosecco.geog.psu.edu/'</span>, <span class='no'>file.name</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>''</span>),
                <span class='kw'>destfile</span> <span class='kw'>=</span> <span class='no'>file.name</span>)
}

<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span>(<span class='no'>file.name</span>)

<span class='co'># We use independent search configuration.</span>
<span class='no'>config</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generateConfiguration.html'>generateConfiguration</a></span>(<span class='st'>'independentSearch'</span>)

<span class='co'># Set up the start and end indices for test times</span>
<span class='no'>test.start</span> <span class='kw'>&lt;-</span> <span class='fl'>366</span>
<span class='no'>test.end</span> <span class='kw'>&lt;-</span> <span class='fl'>372</span>

<span class='co'># Set up the start and end indices for search times</span>
<span class='no'>search.start</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>search.end</span> <span class='kw'>&lt;-</span> <span class='fl'>365</span>

<span class='co'># Set up forecasts and the time, FLT information</span>
<span class='no'>config</span>$<span class='no'>forecasts</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>Data</span>
<span class='no'>config</span>$<span class='no'>forecast_times</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>Times</span>
<span class='no'>config</span>$<span class='no'>flts</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>FLTs</span>

<span class='co'># Set up observations and the time information</span>
<span class='no'>config</span>$<span class='no'>search_observations</span> <span class='kw'>&lt;-</span> <span class='no'>observations</span>$<span class='no'>Data</span>
<span class='no'>config</span>$<span class='no'>observation_times</span> <span class='kw'>&lt;-</span> <span class='no'>observations</span>$<span class='no'>Times</span>

<span class='co'># Set up the number of members to keep in the analog ensemble</span>
<span class='co'># Empirically, the number of members is the square root of number of search times.</span>
<span class='no'>config</span>$<span class='no'>num_members</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>search.end</span> - <span class='no'>search.start</span> + <span class='fl'>1</span>)

<span class='co'># Set up the variable that we want to generate AnEn for.</span>
<span class='co'># This is the index of parameter in observation parameter names.</span>
<span class='co'>#</span>
<span class='no'>obs.id</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>fcst.id</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>config</span>$<span class='no'>observation_id</span> <span class='kw'>&lt;-</span> <span class='no'>obs.id</span>

<span class='co'># Set up weights for each parameters</span>
<span class='no'>config</span>$<span class='no'>weights</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>)

<span class='co'># Set the test times to generate AnEn for</span>
<span class='no'>config</span>$<span class='no'>test_times_compare</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>Times</span>[<span class='no'>test.start</span>:<span class='no'>test.end</span>]

<span class='co'># Set the search times to generate AnEn from</span>
<span class='no'>config</span>$<span class='no'>search_times_compare</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>Times</span>[<span class='no'>search.start</span>:<span class='no'>search.end</span>]

<span class='co'># Set circular variable if there is any</span>
<span class='kw'>if</span> (<span class='st'>'ParameterCirculars'</span> <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>forecasts</span>)) {
  <span class='no'>config</span>$<span class='no'>circulars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>forecasts</span>$<span class='no'>ParameterCirculars</span>, <span class='kw'>function</span>(<span class='no'>x</span>) {
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>(<span class='no'>x</span> <span class='kw'>==</span> <span class='no'>forecasts</span>$<span class='no'>ParameterNames</span>))}))
}

<span class='no'>AnEn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generateAnalogs.html'>generateAnalogs</a></span>(<span class='no'>config</span>)

<span class='no'>start.time</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='st'>'2018-06-01'</span>, <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>'UTC'</span>)
<span class='no'>end.time</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='st'>'2018-06-07'</span>, <span class='kw'>tz</span> <span class='kw'>=</span> <span class='st'>'UTC'</span>)

<span class='no'>obs.times</span> <span class='kw'>&lt;-</span> <span class='no'>observations</span>$<span class='no'>Times</span>
<span class='no'>obs.data</span> <span class='kw'>&lt;-</span> <span class='no'>observations</span>$<span class='no'>Data</span>

<span class='no'>anen.times</span> <span class='kw'>&lt;-</span> <span class='no'>config</span>$<span class='no'>test_times_compare</span>
<span class='no'>anen.flts</span> <span class='kw'>&lt;-</span> <span class='no'>config</span>$<span class='no'>flts</span>
<span class='no'>anen.data</span> <span class='kw'>&lt;-</span> <span class='no'>AnEn</span>$<span class='no'>analogs</span>[, , , , <span class='fl'>1</span>]

<span class='no'>fcst.times</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>Times</span>
<span class='no'>fcst.flts</span> <span class='kw'>&lt;-</span> <span class='no'>config</span>$<span class='no'>flts</span>
<span class='no'>fcst.data</span> <span class='kw'>&lt;-</span> <span class='no'>forecasts</span>$<span class='no'>Data</span>

<span class='co'># fcst.id &lt;- NULL</span>
<span class='co'># fcst.times &lt;- NULL</span>
<span class='co'># fcst.flts &lt;- NULL</span>
<span class='co'># fcst.data &lt;- NULL</span>

<span class='no'>i.station</span> <span class='kw'>&lt;-</span> <span class='fl'>14</span>

<span class='no'>par.name</span> <span class='kw'>&lt;-</span> <span class='no'>observations</span>$<span class='no'>ParameterNames</span>[<span class='no'>obs.id</span>]

<span class='fu'>plotAnalogTimeSeries</span>(
  <span class='no'>start.time</span>, <span class='no'>end.time</span>, <span class='no'>i.station</span>,
  <span class='no'>obs.id</span>, <span class='no'>obs.times</span>, <span class='no'>obs.data</span>,
  <span class='no'>anen.times</span>, <span class='no'>anen.flts</span>, <span class='no'>anen.data</span>,
  <span class='no'>fcst.id</span>, <span class='no'>fcst.times</span>, <span class='no'>fcst.flts</span>, <span class='no'>fcst.data</span>,
  <span class='kw'>par.name</span> <span class='kw'>=</span> <span class='no'>par.name</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://weiming.ddns.net'>Weiming Hu</a>, <a href='http://geoinf.psu.edu/'>Guido Cervone</a>, <a href='http://geoinf.psu.edu/'>Laura Clemente-Harding</a>, <a href='http://geoinf.psu.edu/'>Martina Calovi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


