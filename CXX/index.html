<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AnalogEnsemble: Parallel Ensemble Forecast Package</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AnalogEnsemble
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Parallel Ensemble Forecast Package </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://opensource.org/licenses/MIT"></a> <a href="https://www.codacy.com?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=Weiming-Hu/AnalogsEnsemble&amp;amp;utm_campaign=Badge_Grade"></a> <a href="https://travis-ci.com/Weiming-Hu/AnalogsEnsemble"></a> <a href="https://codecov.io/gh/Weiming-Hu/AnalogsEnsemble"></a></p>
<p><em>This document is still under development.</em></p>
<ul>
<li><a href="#about">About</a></li>
<li><a href="#requirement-and-dependencies">Requirement and Dependencies</a><ul>
<li><a href="#on-mac">On Mac</a></li>
<li><a href="#on-linux">On Linux</a></li>
</ul>
</li>
<li><a href="#installation">Installation</a><ul>
<li><a href="#c-program-and-libraries">C Program and Libraries</a></li>
<li><a href="#r-package">R Package</a><ul>
<li><a href="#use-released-tarball-file">Use Released Tarball File</a></li>
<li><a href="#compile-from-source">Compile from Source</a></li>
</ul>
</li>
<li><a href="#cmake-tunable-parameters-look-up">CMake Tunable Parameters Look-up</a></li>
</ul>
</li>
<li><a href="#known-issues">Known Issues</a></li>
<li><a href="#feedbacks">Feedbacks</a></li>
</ul>
<h2>About</h2>
<p>Parallel Ensemble Forecast package uses a numerical weather prediction algorithm, called Analog Ensemble (<a class="el" href="class_an_en.html" title="AnEn class provides interfaces for computing Analog Ensembles. ">AnEn</a>), to generate ensemble forecasts. Ensemble members, also referred to as analogs, are selected based on the similarity between the current multivariate forecasts and the historical forecasts. It has been successfully applied to forecasts of several weather variables, for example, short-term temperature and wind speed predictions.</p>
<p>This package contains several libraries and applications:</p>
<ul>
<li><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/CAnEn">CAnEn</a>: This is the main library that is implemented in C++. It provides main functionality of the <a class="el" href="class_an_en.html" title="AnEn class provides interfaces for computing Analog Ensembles. ">AnEn</a> method;</li>
<li><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/CAnalogsIO">CAnalogsIO</a>: This is the library for file I/O. Currently, it supports reading and writing <a href="https://www.unidata.ucar.edu/software/netcdf/">standard NetCDF</a>.</li>
<li><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/RAnalogs">RAnalogs</a>: This is a R library which provides the interface for <em>CAnEn</em> functionality, in order to appeal researchers who are prefer R. This R package is called <em>RAnEn</em> which stands for <em>R <a class="el" href="class_analogs.html" title="This is the class to store analogs. The default dimensions are: [test stations][test times][FLTs][mem...">Analogs</a> Ensemble</em>.</li>
<li><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/app_analogGenerator">Analog Generator</a>: This is an application for generating analogs. It is currently under-development.</li>
<li><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/app_analogSelector">Analog Selector</a>: This is an application for selecting analogs based on the similarity matrices. It is currently under-development.</li>
<li><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/app_similarityCalculator">Similarity Calculator</a>: This is an application for calculating the similarity matrices.</li>
</ul>
<p><b>This package has been developed and tested on Linux and MacOS and is not guaranteed on Windows.</b></p>
<h2>Requirement and Dependencies</h2>
<p>A list of requirement and dependency is provided below. Note that you don't necessarily have to install them all before installing the CAnEn library because some of them can be automatically installed during the make process, or because you may not want to install only parts of the modules.</p>
<table class="doxtable">
<tr>
<th align="center">Dependency </th><th align="center">Description  </th></tr>
<tr>
<td align="center">CMake </td><td align="center">Required for the C++ program. </td></tr>
<tr>
<td align="center">GCC/Clang </td><td align="center">Required for the C++ program. </td></tr>
<tr>
<td align="center">NetCDF-C </td><td align="center">Optional for the C++ program. If it is not found, the project will try to build it. </td></tr>
<tr>
<td align="center">Boost C++ </td><td align="center">Optional for the C++ program. It is recommended to let the project build it for the C++ program. </td></tr>
<tr>
<td align="center">CppUnit </td><td align="center">Optional for the C++ program when building tests. </td></tr>
<tr>
<td align="center">R </td><td align="center">Required for the R library. </td></tr>
<tr>
<td align="center">OpenMP </td><td align="center">Optional for both R and C++. </td></tr>
</table>
<h3>On Mac</h3>
<p>It is fairly straightforward to use <code>HomeBrew</code>() to manage packages. However, note that <code>HomeBrew</code> might not be working well with <code>Port</code>. If you already have one of the two, go with the desired one.</p>
<div class="fragment"><div class="line"># Install GNU compilers to support OpenMP</div><div class="line"># brew search gcc</div><div class="line">brwe install gcc@7</div><div class="line"></div><div class="line"># Install CMake</div><div class="line"># brew search cmake</div><div class="line">brew install cmake</div><div class="line"></div><div class="line"># Install NetCDF</div><div class="line">brew install netcdf</div></div><!-- fragment --><h3>On Linux</h3>
<p>If <code>apt-get</code> is available, please see the following commands.</p>
<div class="fragment"><div class="line"># Install NetCDF</div><div class="line">sudo apt-get install libnetcdf-dev netcdf-bin</div></div><!-- fragment --><h2>Installation</h2>
<h3>C Program and Libraries</h3>
<p>The installation process can be divided into two steps:</p>
<ul>
<li>generate make files</li>
<li>build programs and libraries</li>
</ul>
<p>First, let's create a <code>build/</code> folder where it stores our automatically generated files. This is also called an out-of-source build.</p>
<div class="fragment"><div class="line">cd AnalogsEnsemble</div><div class="line">mkdir build</div><div class="line">cd build</div></div><!-- fragment --><p>Then, generate the make files.</p>
<div class="fragment"><div class="line">CC=[full path to CC] CXX=[full path to CXX] cmake ..</div></div><!-- fragment --><p>Read the output messages. If you would like to make any changes and generate new make files, please delete all the files in <code>build/</code> folder first. Otherwise, you will not change anything.</p>
<p>After having the make files generated, please go ahead and install the program.</p>
<div class="fragment"><div class="line">make</div><div class="line"></div><div class="line"># Or if you are using UNIX system, use the flag -j[number of cores] to parallelize the make process</div><div class="line">make -j4</div><div class="line"></div><div class="line"># Build document if desired. The /html and the /man folders will be in your build directory</div><div class="line">make document</div></div><!-- fragment --><p>After the compilation, the programs and libraries should be in the foler AnalogsEnsemble/output.</p>
<p>If you want to clean up the folder, please do the following.</p>
<div class="fragment"><div class="line">make clean</div></div><!-- fragment --><h3>R Package</h3>
<h5>Use Released Tarball File</h5>
<p>Generally, the following R packages are needed:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/BH/index.html">BH</a></li>
<li><p class="startli"><a href="https://cran.r-project.org/web/packages/Rcpp/index.html">Rcpp</a></p>
<p class="startli">If you are using <code>Windows</code>, please install the following programs:</p>
</li>
<li><a href="https://cran.r-project.org/bin/windows/base/">R for Windows</a></li>
<li><a href="https://cran.r-project.org/bin/windows/Rtools/">Latest Rtools</a></li>
</ul>
<p>Please find a tarball file under <a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/releases"><code>CAnalogs/RAnalogs/releases</code></a>. That is the package file you need to install inside R later. Then, open an R session, and run the following command.</p>
<div class="fragment"><div class="line">#install.packages(&quot;BH&quot;)</div><div class="line">#install.packages(&quot;Rcpp&quot;)</div><div class="line"></div><div class="line"># The quiet option is to reduce the amount of standard output. Switch the parameter</div><div class="line"># if you prefer to see the full list of warnings</div><div class="line">#</div><div class="line">install.packages(&quot;[full path to the tarball file]&quot;, type = &quot;source&quot;, repo = NULL, quiet = T)</div></div><!-- fragment --><p>On <em>Windows</em>, please separate folder names with <code>\\</code>.</p>
<p>If you want to use a different compiler, an easy workaround is to create a <code>Makevars</code> file under <code>~/.R</code>, with the following content.</p>
<div class="fragment"><div class="line">CXX1X=[C++11 compiler]</div><div class="line"></div><div class="line"># required on Mac OS</div><div class="line">CXX11=[C++11 compiler]</div></div><!-- fragment --><p>After this, you should see the same compiler in the standard output.</p>
<h5>Compile from Source</h5>
<p>First, let's create a <code>build/</code> folder where it stores our automatically generated files.</p>
<div class="fragment"><div class="line">cd AnalogsEnsemble</div><div class="line">mkdir build</div><div class="line">cd build</div></div><!-- fragment --><p>Then, let's generate the make files.</p>
<div class="fragment"><div class="line">cmake -DINSTALL_RAnEn=ON -G &quot;Unix Makefiles&quot; ..</div></div><!-- fragment --><p>Read the output messages. If you would like to make any changes and generate new make files, please delete all the files in <code>build/</code> folder first. Otherwise, you will not change anything because of the existed files.</p>
<p>After the make files have been generated, go ahead and install the R package.</p>
<div class="fragment"><div class="line">make</div></div><!-- fragment --><p>The following command installs the R package.</p>
<div class="fragment"><div class="line">make install</div></div><!-- fragment --><p>The following command generates a new tarball file into the <code>releases</code> folder and overwrites the old file if file already existst.</p>
<div class="fragment"><div class="line">make build-release</div></div><!-- fragment --><p>Clean up the files after the make process.</p>
<div class="fragment"><div class="line">make clean-rsrc</div><div class="line">make clean</div></div><!-- fragment --><h3>CMake Tunable Parameters Look-up</h3>
<table class="doxtable">
<tr>
<th align="center">Parameter </th><th align="center">Explanation </th><th align="center">Default  </th></tr>
<tr>
<td align="center">CC </td><td align="center">The C compiler to use. </td><td align="center">[System dependent] </td></tr>
<tr>
<td align="center">CXX </td><td align="center">The C++ compiler to use. </td><td align="center">[System dependent] </td></tr>
<tr>
<td align="center">INSTALL_RAnEn </td><td align="center">Build and install the <code>RAnEn</code> library. </td><td align="center">OFF </td></tr>
<tr>
<td align="center">BOOST_TYPE </td><td align="center"><code>BUILD</code> for building <code>Boost</code> library; <code>SYSTEM</code> for using the <code>Boost</code> library installed on the system. </td><td align="center">BUILD </td></tr>
<tr>
<td align="center">CMAKE_BUILD_TYPE </td><td align="center"><code>Release</code> for release mode; <code>Debug</code> for debug mode. </td><td align="center">Release </td></tr>
<tr>
<td align="center">CMAKE_BUILD_TESTS </td><td align="center">Build and install tests. </td><td align="center">OFF </td></tr>
<tr>
<td align="center">BUILD_NETCDF </td><td align="center">Build <code>NetCDF</code> library. </td><td align="center">OFF </td></tr>
<tr>
<td align="center">BUILD_HDF5 </td><td align="center">Build <code>HDF5</code> library. </td><td align="center">OFF </td></tr>
<tr>
<td align="center">VERBOSE </td><td align="center">Verbose output. </td><td align="center">OFF </td></tr>
</table>
<p><em>Table generated from <a href="https://www.tablesgenerator.com/markdown_tables">Tables Generator</a>.</em></p>
<h2>Known Issues</h2>
<ul>
<li><code>RAnEn</code> is built with GNU compiler and CMake process. But it shows up not supporting <code>OpenMP</code>.</li>
</ul>
<p>If you have run the <code>roxygen</code> command before the make process, the library will not be supporting <code>OpenMP</code>. Make sure that before your CMake's runtime, you have a <code>clean</code> directory under <code>RAnalogs/RAnEn/src</code>. An easy way to do this is to run <code>make clean-roxygen</code>, and repeat the build and make process.</p>
<ul>
<li>Linking errors when building the C++ library during the second time.</li>
</ul>
<p>If you have successfully built the C++ library before and when you modifed any files or did a <code>git pull</code>, you found the <code>make</code> process failed. This can be caused by using the old dependencies previously built and stored in the <code>dependency/</code> directory. This typically happens when you've also changed the compiler. An easy workaround for this is to remove all the build files, include the directories <code>dependency\</code>, <code>output\</code>, and <code>build\</code>, and start from scratch with a clean directory.</p>
<ul>
<li>How do I make sure whether <code>OpenMP</code> is supported.</li>
</ul>
<p>If you are using the <code>RAnEn</code> library, you can check the automatic message printed on loading the library. If it does not say "OpenMP is not supported", then it is supported.</p>
<p>If you are using the C++ programs, you need to first build tests by specifying <code>-DCMAKE_BUILD_TESTS=ON</code> to <code>cmake</code>. Then after the program compiles, there is a test at <code>AnalogsEnsemble/output/test/runAnEn</code>. If you see <code>OpenMP is supported</code> and the number of threads in the standard output message after running the test executable, <code>OpenMP</code> is correctly configured. You can also try to modify the system environment variable <code>OMP_NUM_THREADS</code> and run the test executable again, see how the system environment variable affects the number of threads being created.</p>
<h2>Feedbacks</h2>
<p>We appreciate collaborations and feedbacks from users. Please contact maintainer <a href="http://weiming.ddns.net">Weiming Hu</a> through <a href="weiming@psu.edu">weiming@psu.edu</a>, or create tickets if you have any problems.</p>
<p>Thank you!</p>
<div class="fragment"><div class="line"># &quot;`-&#39;&#39;-/&quot;).___..--&#39;&#39;&quot;`-._</div><div class="line">#  (`6_ 6  )   `-.  (     ).`-.__.`)   WE ARE ...</div><div class="line">#  (_Y_.)&#39;  ._   )  `._ `. ``-..-&#39;    PENN STATE!</div><div class="line">#    _ ..`--&#39;_..-_/  /--&#39;_.&#39; ,&#39;</div><div class="line">#  (il),-&#39;&#39;  (li),&#39;  ((!.-&#39;</div><div class="line"># </div><div class="line"># Author: Weiming Hu &lt;weiming@psu.edu&gt;</div><div class="line">#         Guido Cervone &lt;cervone@psu.edu&gt;</div><div class="line">#</div><div class="line"># Contributor: </div><div class="line">#         Laura Clemente-Harding</div><div class="line">#         Martina Calovi</div><div class="line">#         </div><div class="line"># Geoinformatics and Earth Observation Laboratory (http://geolab.psu.edu)</div><div class="line"># Department of Geography and Institute for CyberScience</div><div class="line"># The Pennsylvania State University</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
