<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ParallelAnalogEnsemble: doc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ParallelAnalogEnsemble
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">doc </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
 <h2>layout: default </h2>
<h1><a href="https://weiming-hu.github.io/AnalogsEnsemble/">PAnEn: Parallel Analog Ensemble</a></h1>
<p><a href="https://zenodo.org/badge/latestdoi/130093968"></a> <a href="https://opensource.org/licenses/MIT"></a> <a href="https://www.codacy.com?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=Weiming-Hu/AnalogsEnsemble&amp;amp;utm_campaign=Badge_Grade"></a> <a href="https://travis-ci.com/Weiming-Hu/AnalogsEnsemble"></a> <a href="https://codecov.io/gh/Weiming-Hu/AnalogsEnsemble"></a> <a href="https://www.tidyverse.org/lifecycle/#experimental"></a> <a href="https://mybinder.org/v2/gh/Weiming-Hu/AnalogsEnsemble/master?urlpath=rstudio"></a> <a href="https://hub.docker.com/r/weiminghu123/panen"></a></p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#citation">Citation</a></li>
<li><a href="#installation">Installation</a><ul>
<li><a href="#ranen">RAnEn</a></li>
<li><a href="#canen">CAnEn</a></li>
<li><a href="#cmake-parameters">CMake Parameters</a></li>
<li><a href="#high-performance-computing-and-supercomputers">High-Performance Computing and Supercomputers</a></li>
<li><a href="#mpi-and-openmp">MPI and OpenMP</a></li>
</ul>
</li>
<li><a href="#tutorials">Tutorials</a></li>
<li><a href="#references">References</a></li>
<li><a href="#feedbacks">Feedbacks</a></li>
</ul>
<h2>Overview</h2>
<p>Parallel Analog Ensemble (PAnEn) generates accurate forecast ensembles relying on a single deterministic model simulation and the historical observations. The technique was introduced by Luca Delle Monache et al. in the paper <a href="https://journals.ametsoc.org/doi/full/10.1175/MWR-D-12-00281.1">Probabilistic Weather Prediction with an Analog Ensemble</a>. Developed and maintained by <a href="http://geolab.psu.edu">GEOlab</a> at Penn State, PAnEn aims to provide an efficient implementation for this technique and user-friendly interfaces in R and C++ for researchers who want to use this technique in their own research.</p>
<p>The easiest way to use this package is to install the R package, 'RAnEn'. C++ libraries are also available but they are designed for intermediate users with requirement for performance. For installation guidance, please refer to the <a href="#installation">installation section</a>.</p>
<h2>Citation</h2>
<p>To cite this package, you have several options:</p>
<ul>
<li>Using <code>LaTex</code>: Please use <a href="https://github.com/Weiming-Hu/AnalogsEnsemble/blob/master/RAnalogs/RAnEn/inst/CITATION">this file</a> for citation.</li>
<li>Using <code>R</code>: Simply type `citation('RAnEn')` and the citation message will be printed.</li>
<li>Using plain text: Please use the following citation format:</li>
</ul>
<div class="fragment"><div class="line">Weiming Hu, Guido Cervone, Laura Clemente-Harding, and Martina Calovi. (2019). Parallel Analog Ensemble. Zenodo. http://doi.org/10.5281/zenodo.3384321</div></div><!-- fragment --><h2>Installation</h2>
<p><code>RAnEn</code> is very easy to install if you are already using <a href="https://www.r-project.org/">R</a>. This is the recommended way to start.</p>
<h3>RAnEn</h3>
<p><em>The command is the same for <code>RAnEn</code> installation and update.</em></p>
<p>To install <code>RAnEn</code>, please install the following packages first:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/BH/index.html">BH</a>: `install.packages('BH')<code></code></li>
<li><code>[Rcpp](<a href="https://cran.r-project.org/web/packages/Rcpp/index.html">https://cran.r-project.org/web/packages/Rcpp/index.html</a>):</code>install.packages('Rcpp')<code></code></li>
<li><code>If you are using</code>Windows`, please also install the latest version of <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>.</li>
</ul>
<p>The following R command install the latest <code>RAnEn</code>.</p>
<div class="fragment"><div class="line">install.packages(&quot;https://github.com/Weiming-Hu/AnalogsEnsemble/raw/master/RAnalogs/releases/RAnEn_latest.tar.gz&quot;, repos = NULL)</div></div><!-- fragment --><p>That's it. You are good to go. Please refer to <a href="#tutorials">tutorials</a> or the <a href="https://weiming-hu.github.io/AnalogsEnsemble/R/">R documentation</a> to learn more about using <code>RAnEn</code>.</p>
<h3>CAnEn</h3>
<p>To install the C++ libraries, please check the following dependencies:</p>
<ul>
<li><em>Required</em> <a href="https://cmake.org/">CMake</a> is the required build system generator.</li>
<li><em>Required</em> <a href="https://www.unidata.ucar.edu/downloads/netcdf/">NetCDF</a> provides the file I/O with NetCDF files.</li>
<li><em>Required</em> <a href="https://confluence.ecmwf.int/display/ECC/ecCodes+installation">Eccodes</a> provides the file I/O with Grib2 files.</li>
<li><em>Optional</em> <a href="https://www.boost.org/">Boost</a> provides high-performance data structures. <code>Boost</code> is a very large library. If you don't want to install the entire package, <code>PAnEn</code> is able to build the required ones automatically.</li>
<li><em>Optional</em> <code>CppUnit</code> provides test frameworks. If <code>CppUnit</code> is found in the system, test programs will be compiled.</li>
</ul>
<p>Please use the following scripts to install the libraries:</p>
<div class="fragment"><div class="line"># Download the source files (~10 Mb)</div><div class="line">wget https://github.com/Weiming-Hu/AnalogsEnsemble/archive/master.zip</div><div class="line"></div><div class="line"># Unzip</div><div class="line">unzip master.zip</div><div class="line"></div><div class="line"># Create a separate folder to store all intermediate files during the installation process</div><div class="line">cd AnalogsEnsemble-master/</div><div class="line">mkdir build</div><div class="line">cd build</div><div class="line">cmake -DCMAKE_INSTALL_PREFIX=~/AnalogEnsemble ..</div><div class="line"></div><div class="line"># Compile</div><div class="line">make -j 4</div><div class="line"></div><div class="line"># Install</div><div class="line">make install</div></div><!-- fragment --><h3>CMake <a class="el" href="class_parameters.html" title="Parameters class stores Parameter objects. It is a bidirectional map implemented from Boost so that i...">Parameters</a></h3>
<p>Below is a list of parameters you can change and customize.</p>
<table class="doxtable">
<tr>
<th align="center"><a class="el" href="class_parameter.html" title="Parameter stores parameter information including name and circular. ">Parameter</a> </th><th align="center">Explanation </th><th align="center">Default  </th></tr>
<tr>
<td align="center">CMAKE_C_COMPILER </td><td align="center">The C compiler to use. </td><td align="center">[System dependent] </td></tr>
<tr>
<td align="center">CMAKE_CXX_COMPILER </td><td align="center">The C++ compiler to use. </td><td align="center">[System dependent] </td></tr>
<tr>
<td align="center">CMAKE_INSTALL_PREFIX</td><td align="center">The installation directory. </td><td align="center">[System dependent] </td></tr>
<tr>
<td align="center">CMAKE_PREFIX_PATH </td><td align="center">Which folder(s) should cmake search for packages besides the default. Paths are surrounded by double quotes and separated with semicolons. </td><td align="center">[Empty] </td></tr>
<tr>
<td align="center">CMAKE_INSTALL_RPATH</td><td align="center">The run-time library path. Paths are surrounded by double quotes and separated with semicolons. </td><td align="center">[Empty] </td></tr>
<tr>
<td align="center">CMAKE_BUILD_TYPE </td><td align="center"><code>Release</code> for release mode; <code>Debug</code> for debug mode. </td><td align="center">Release </td></tr>
<tr>
<td align="center">INSTALL_RAnEn </td><td align="center">Build and install the <code>RAnEn</code> library. </td><td align="center">OFF </td></tr>
<tr>
<td align="center">BUILD_BOOST </td><td align="center">Build <code>Boost</code> regardless of whether it exists in the system. </td><td align="center">OFF </td></tr>
<tr>
<td align="center">BOOST_URL </td><td align="center">The URL for downloading Boost. This is only used when <code>BUILD_BOOST</code> is <code>ON</code>. </td><td align="center">[From SourceForge] </td></tr>
<tr>
<td align="center">ENABLE_MPI </td><td align="center">Build the MPI supported libraries and executables. This requires the MPI dependency. </td><td align="center">OFF </td></tr>
</table>
<p>You can change the default of the parameters, for example, <code>cmake -DCMAKE_INSTALL_PREFIX=~/AnalogEnsemble ..</code>. Don't forget the extra letter <code>D</code> when specifying argument names.</p>
<h3>High-Performance Computing and Supercomputers</h3>
<p><a href="https://github.com/Weiming-Hu/AnalogsEnsemble/issues/86">Here</a> is a list of instructions to build and install <code><a class="el" href="class_an_en.html" title="AnEn is an abstract class that defines the interface for implement analog ensemble generation...">AnEn</a></code> on supercomputers.</p>
<h3>MPI and OpenMP</h3>
<p>When <code>ENABLE_MPI</code> is turned on, MPI programs will be built and available. These MPI programs are hybrid programs that use both MPI and OpenMP. Please check with your individual supercomputer platform to find out <b>what the proper configuration for launching an MPI + OpenMP hybrid program is</b>.</p>
<p>For example, on <a href="https://www2.cisl.ucar.edu/resources/computational-systems/cheyenne">NCAR Cheyenne</a>, the proper way to launch a hybrid program can be found <a href="https://www2.cisl.ucar.edu/resources/computational-systems/cheyenne/running-jobs/pbs-pro-job-script-examples">here</a>. If you use <code>mpirun</code>, instead of <code>mpiexec_mpt</code>, you will loose the multi-threading performance improvement.</p>
<p>To dive deeper into the hybrid parallelization design, MPI is used during the file I/O process and OpenMP is used during the analog computing process.</p>
<p>When analogs with a long search and test periods are desired, MPI is used to distribute forecast files across processes. Each process reads a subset of the forecast files. This solves the problem where serial I/O can be very slow.</p>
<p>After the file I/O, all other processes are terminated except for the master process, which will then enter the multi-threading parallelization scope. It is important to keep in mind that only the master process will be alive after the file I/O process and that only the master process enters multi-threading parallelization. MPI processes will NOT spawn multiple threads.</p>
<h2>Tutorials</h2>
<p>Tutorials can be accessed on <a href="https://mybinder.org/v2/gh/Weiming-Hu/AnalogsEnsemble/master?urlpath=rstudio">binder</a> or be found in <a href="https://github.com/Weiming-Hu/AnalogsEnsemble/tree/master/RAnalogs/examples">this directory</a></p>
<p>Here are also some tips and caveats in <a href="https://github.com/Weiming-Hu/AnalogsEnsemble/issues/81">this ticket</a>.</p>
<h2>References</h2>
<ul>
<li><a href="https://journals.ametsoc.org/doi/full/10.1175/MWR-D-12-00281.1">Delle Monache, Luca, et al. "Probabilistic weather prediction with an analog ensemble." Monthly Weather Review 141.10 (2013): 3498-3516.</a></li>
<li><a href="https://ral.ucar.edu/sites/default/files/public/images/events/WISE_documentation_20170725_Final.pdf">Clemente-Harding, L. A Beginners Introduction to the Analog Ensemble Technique</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S0960148117301386">Cervone, Guido, et al. "Short-term photovoltaic power forecasting using Artificial Neural Networks and an Analog Ensemble." Renewable energy 108 (2017): 274-286.</a></li>
<li><a href="https://www.researchgate.net/profile/Constantin_Junk/publication/274951815_Predictor-weighting_strategies_for_probabilistic_wind_power_forecasting_with_an_analog_ensemble/links/552cd5710cf29b22c9c47260.pdf">Junk, Constantin, et al. "Predictor-weighting strategies for probabilistic wind power forecasting with an analog ensemble." Meteorol. Z 24.4 (2015): 361-379.</a></li>
<li><a href="https://ieeexplore.ieee.org/abstract/document/8425207">Balasubramanian, Vivek, et al. "Harnessing the power of many: Extensible toolkit for scalable ensemble applications." 2018 IEEE International Parallel and Distributed Processing Symposium (IPDPS). IEEE, 2018.</a></li>
</ul>
<h2>Feedbacks</h2>
<p>We appreciate collaborations and feedbacks from users. Please contact the maintainer <a href="https://weiming-hu.github.io">Weiming Hu</a> through <a href="weiming@psu.edu">weiming@psu.edu</a> or submit tickets if you have any problems.</p>
<p>Thank you!</p>
<div class="fragment"><div class="line"># &quot;`-&#39;&#39;-/&quot;).___..--&#39;&#39;&quot;`-._</div><div class="line">#  (`6_ 6  )   `-.  (     ).`-.__.`)   WE ARE ...</div><div class="line">#  (_Y_.)&#39;  ._   )  `._ `. ``-..-&#39;    PENN STATE!</div><div class="line">#    _ ..`--&#39;_..-_/  /--&#39;_.&#39; ,&#39;</div><div class="line">#  (il),-&#39;&#39;  (li),&#39;  ((!.-&#39;</div><div class="line"># </div><div class="line"># Authors: </div><div class="line">#     Weiming Hu &lt;weiming@psu.edu&gt;</div><div class="line">#     Guido Cervone &lt;cervone@psu.edu&gt;</div><div class="line">#     Laura Clemente-Harding &lt;lec170@psu.edu&gt;</div><div class="line">#     Martina Calovi &lt;mcalovi@psu.edu&gt;</div><div class="line">#</div><div class="line"># Contributors: </div><div class="line">#     Luca Delle Monache</div><div class="line">#         </div><div class="line"># Geoinformatics and Earth Observation Laboratory (http://geolab.psu.edu)</div><div class="line"># Department of Geography and Institute for CyberScience</div><div class="line"># The Pennsylvania State University</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
