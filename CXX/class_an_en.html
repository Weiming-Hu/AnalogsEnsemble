<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AnalogEnsemble: AnEn Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AnalogEnsemble
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_an_en-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AnEn Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="class_an_en.html" title="AnEn class provides interfaces for computing Analog Ensembles. ">AnEn</a> class provides interfaces for computing Analog Ensembles.  
 <a href="class_an_en.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_an_en_8h_source.html">AnEn.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for AnEn:</div>
<div class="dyncontent">
<div class="center"><img src="class_an_en__coll__graph.png" border="0" usemap="#_an_en_coll__map" alt="Collaboration graph"/></div>
<map name="_an_en_coll__map" id="_an_en_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a94dd770690ca98baca9c2a62a36bc62a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a> { <a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62aa951dc29c260676ddba508790abfdb2d0">OneToOne</a> = 1, 
<a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62aade3456ad0e377ebc7ffb374454433326">OneToMany</a> = 2
 }</td></tr>
<tr class="separator:a94dd770690ca98baca9c2a62a36bc62a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ceab50f0bf394bd35871469d5a36b2"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> = <a class="el" href="class_functions.html#a1e68b8656e6b5405d550e1d197c2d10e">Functions::TimeMapMatrix</a></td></tr>
<tr class="separator:a44ceab50f0bf394bd35871469d5a36b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc55d358a20ee6bb711ca5efb33a1bb0"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">SearchStationMatrix</a> = boost::numeric::ublas::matrix&lt; double &gt;</td></tr>
<tr class="separator:adc55d358a20ee6bb711ca5efb33a1bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a60c12de232af95794a6194fbac06623a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a60c12de232af95794a6194fbac06623a">AnEn</a> ()</td></tr>
<tr class="separator:a60c12de232af95794a6194fbac06623a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71a7c34cc125ce75e1377fd6f62988da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a71a7c34cc125ce75e1377fd6f62988da">AnEn</a> (int verbose)</td></tr>
<tr class="separator:a71a7c34cc125ce75e1377fd6f62988da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97a51c40812584b01413a4426b1285a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a97a51c40812584b01413a4426b1285a6">AnEn</a> (const <a class="el" href="class_an_en.html">AnEn</a> &amp;orig)=delete</td></tr>
<tr class="separator:a97a51c40812584b01413a4426b1285a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18609907411058ee2c343727ab69bff4"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a18609907411058ee2c343727ab69bff4">~AnEn</a> ()</td></tr>
<tr class="separator:a18609907411058ee2c343727ab69bff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8be9b16b5e5e1cf30f61b4ecac2faee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#ad8be9b16b5e5e1cf30f61b4ecac2faee">computeSearchStations</a> (const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;test_stations, const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;search_stations, <a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">SearchStationMatrix</a> &amp;i_search_stations, size_t max_num_search_stations=1, double distance=0, size_t num_nearest_stations=0) const</td></tr>
<tr class="separator:ad8be9b16b5e5e1cf30f61b4ecac2faee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bc8ce00b972749d4e4cbfbf4bf45b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a97bc8ce00b972749d4e4cbfbf4bf45b5">generateOperationalSearchTimes</a> (const <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> &amp;test_times, const <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> &amp;search_times, std::vector&lt; <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> &gt; &amp;search_times_operational, std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;i_search_times_operational, double max_flt) const</td></tr>
<tr class="separator:a97bc8ce00b972749d4e4cbfbf4bf45b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad032b4a80d86c6c31ef26a3eb381cb5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#ad032b4a80d86c6c31ef26a3eb381cb5d">computeSimilarity</a> (const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;test_forecasts, const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;search_forecasts, const <a class="el" href="class_standard_deviation.html">StandardDeviation</a> &amp;sds, <a class="el" href="class_similarity_matrices.html">SimilarityMatrices</a> &amp;sims, const <a class="el" href="class_observations__array.html">Observations_array</a> &amp;search_observations, const <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> &amp;mapping, const <a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">SearchStationMatrix</a> &amp;i_search_stations, size_t i_observation_parameter=0, bool extend_observations=false, double max_par_nan=0, double max_flt_nan=0, <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> test_times={}, <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> search_times={}, bool operational=false) const</td></tr>
<tr class="separator:ad032b4a80d86c6c31ef26a3eb381cb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e2b88cda5cc9fce8ea4703a3236719c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a8e2b88cda5cc9fce8ea4703a3236719c">selectAnalogs</a> (<a class="el" href="class_analogs.html">Analogs</a> &amp;analogs, <a class="el" href="class_similarity_matrices.html">SimilarityMatrices</a> &amp;sims, const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;test_stations, const <a class="el" href="class_observations__array.html">Observations_array</a> &amp;search_observations, const <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> &amp;mapping, size_t i_parameter, size_t num_members, bool quick=true, bool extend_observations=false) const</td></tr>
<tr class="separator:a8e2b88cda5cc9fce8ea4703a3236719c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa937a792202a83e88df6e019a991b848"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#aa937a792202a83e88df6e019a991b848">getVerbose</a> () const</td></tr>
<tr class="separator:aa937a792202a83e88df6e019a991b848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e703c85514bb4768278bebe20fe4642"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a5e703c85514bb4768278bebe20fe4642">getMethod</a> () const</td></tr>
<tr class="separator:a5e703c85514bb4768278bebe20fe4642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6b6018f1ca8b138af2aaafe5464cbd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#afd6b6018f1ca8b138af2aaafe5464cbd">setMethod</a> (<a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a> method)</td></tr>
<tr class="separator:afd6b6018f1ca8b138af2aaafe5464cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1009201b008da7395f1c1ed0ec287cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#af1009201b008da7395f1c1ed0ec287cd">setVerbose</a> (int verbose)</td></tr>
<tr class="separator:af1009201b008da7395f1c1ed0ec287cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a085c41c286923d751230f4abf2985292"><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a085c41c286923d751230f4abf2985292">_FILL_VALUE</a> = NAN</td></tr>
<tr class="separator:a085c41c286923d751230f4abf2985292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15e0444046a071247082296d78ed5aa3"><td class="memItemLeft" align="right" valign="top">static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a15e0444046a071247082296d78ed5aa3">_SERIAL_LENGTH_LIMIT</a> = 500</td></tr>
<tr class="separator:a15e0444046a071247082296d78ed5aa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a80044eb55ee5a7b7319dd7101a73db05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a80044eb55ee5a7b7319dd7101a73db05">check_input_</a> (const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;test_forecasts, const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;search_forecasts, const <a class="el" href="class_standard_deviation.html">StandardDeviation</a> &amp;sds, const <a class="el" href="class_observations__array.html">Observations_array</a> &amp;search_observations, const <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> &amp;mapping, const <a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">AnEn::SearchStationMatrix</a> &amp;i_search_stations, size_t i_observation_parameter, double max_par_nan, double max_flt_nan, bool operational) const</td></tr>
<tr class="separator:a80044eb55ee5a7b7319dd7101a73db05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbccb0a25e09ef2353d0f754afe7273e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#afbccb0a25e09ef2353d0f754afe7273e">find_nearest_station_match_</a> (const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;test_stations, const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;search_stations, std::vector&lt; size_t &gt; &amp;test_stations_index_in_search) const</td></tr>
<tr class="separator:afbccb0a25e09ef2353d0f754afe7273e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b2132b93af1850fe2a6cb358936ea19"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a9b2132b93af1850fe2a6cb358936ea19">compute_single_similarity_</a> (const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;test_forecasts, const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;search_forecasts, const <a class="el" href="class_standard_deviation.html">StandardDeviation</a> &amp;sds, const std::vector&lt; double &gt; &amp;weights, const boost::numeric::ublas::matrix&lt; size_t &gt; &amp;flts_window, const std::vector&lt; bool &gt; &amp;circular_flags, size_t i_test_station, size_t i_test_time, size_t i_search_station, size_t i_search_time, size_t i_flt, double max_par_nan, double max_flt_nan) const</td></tr>
<tr class="separator:a9b2132b93af1850fe2a6cb358936ea19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a25984b953516a987e2e9eb23048e5d60"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a25984b953516a987e2e9eb23048e5d60">verbose_</a> = 2</td></tr>
<tr class="separator:a25984b953516a987e2e9eb23048e5d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c503cbae77244126d1616e90a07c92f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_an_en.html#a3c503cbae77244126d1616e90a07c92f">method_</a> = <a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62aa951dc29c260676ddba508790abfdb2d0">OneToOne</a></td></tr>
<tr class="separator:a3c503cbae77244126d1616e90a07c92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="class_an_en.html" title="AnEn class provides interfaces for computing Analog Ensembles. ">AnEn</a> class provides interfaces for computing Analog Ensembles. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="adc55d358a20ee6bb711ca5efb33a1bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc55d358a20ee6bb711ca5efb33a1bb0">&#9670;&nbsp;</a></span>SearchStationMatrix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">AnEn::SearchStationMatrix</a> =  boost::numeric::ublas::matrix&lt;double&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">AnEn::SearchStationMatrix</a> is a lookup table for search stations of each test station. The number of rows is the number of test stations, and the number of column is the maximum number of search stations for each test stations. NA values can exist in the table because the numbers of search stations can vary for test stations. </p>

</div>
</div>
<a id="a44ceab50f0bf394bd35871469d5a36b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ceab50f0bf394bd35871469d5a36b2">&#9670;&nbsp;</a></span>TimeMapMatrix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">AnEn::TimeMapMatrix</a> =  <a class="el" href="class_functions.html#a1e68b8656e6b5405d550e1d197c2d10e">Functions::TimeMapMatrix</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a94dd770690ca98baca9c2a62a36bc62a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94dd770690ca98baca9c2a62a36bc62a">&#9670;&nbsp;</a></span>simMethod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">AnEn::simMethod</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Specifies the how similarity is computed across stations.</p>
<ul>
<li>OneToOne: Each test station is assigned with the closest station in the search stations;</li>
<li>OneToMany: Each test station is assigned with a set of nearby stations in the search stations (Search space extension); </li>
</ul>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a94dd770690ca98baca9c2a62a36bc62aa951dc29c260676ddba508790abfdb2d0"></a>OneToOne&#160;</td><td class="fielddoc"><p>1 </p>
</td></tr>
<tr><td class="fieldname"><a id="a94dd770690ca98baca9c2a62a36bc62aade3456ad0e377ebc7ffb374454433326"></a>OneToMany&#160;</td><td class="fielddoc"><p>2 </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a60c12de232af95794a6194fbac06623a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c12de232af95794a6194fbac06623a">&#9670;&nbsp;</a></span>AnEn() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AnEn::AnEn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a71a7c34cc125ce75e1377fd6f62988da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71a7c34cc125ce75e1377fd6f62988da">&#9670;&nbsp;</a></span>AnEn() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AnEn::AnEn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a97a51c40812584b01413a4426b1285a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97a51c40812584b01413a4426b1285a6">&#9670;&nbsp;</a></span>AnEn() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AnEn::AnEn </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_an_en.html">AnEn</a> &amp;&#160;</td>
          <td class="paramname"><em>orig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a18609907411058ee2c343727ab69bff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18609907411058ee2c343727ab69bff4">&#9670;&nbsp;</a></span>~AnEn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">AnEn::~AnEn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a80044eb55ee5a7b7319dd7101a73db05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80044eb55ee5a7b7319dd7101a73db05">&#9670;&nbsp;</a></span>check_input_()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a> AnEn::check_input_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;&#160;</td>
          <td class="paramname"><em>test_forecasts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;&#160;</td>
          <td class="paramname"><em>search_forecasts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_standard_deviation.html">StandardDeviation</a> &amp;&#160;</td>
          <td class="paramname"><em>sds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_observations__array.html">Observations_array</a> &amp;&#160;</td>
          <td class="paramname"><em>search_observations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">AnEn::SearchStationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>i_search_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_observation_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_par_nan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_flt_nan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>operational</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check input. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test_forecasts</td><td>Test forecasts. </td></tr>
    <tr><td class="paramname">search_forecasts</td><td>Search forecasts. </td></tr>
    <tr><td class="paramname">sds</td><td><a class="el" href="class_standard_deviation.html" title="StandardDeviation class is designed for storing the standard deviation of a Forecasts object...">StandardDeviation</a>. </td></tr>
    <tr><td class="paramname">search_observations</td><td>Search observations. </td></tr>
    <tr><td class="paramname">mapping</td><td>Time and FLT mapping matrix. </td></tr>
    <tr><td class="paramname">i_observation_parameter</td><td>The index of observation parameter used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An errorType. </dd></dl>

</div>
</div>
<a id="a9b2132b93af1850fe2a6cb358936ea19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b2132b93af1850fe2a6cb358936ea19">&#9670;&nbsp;</a></span>compute_single_similarity_()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double AnEn::compute_single_similarity_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;&#160;</td>
          <td class="paramname"><em>test_forecasts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;&#160;</td>
          <td class="paramname"><em>search_forecasts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_standard_deviation.html">StandardDeviation</a> &amp;&#160;</td>
          <td class="paramname"><em>sds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::numeric::ublas::matrix&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>flts_window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>circular_flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_test_station</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_test_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_search_station</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_search_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_flt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_par_nan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_flt_nan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function is the core function for computing a single similarity metric value between two forecasts (usually one test forecast and one historical search forecast).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test_forecasts</td><td>The test forecasts. </td></tr>
    <tr><td class="paramname">search_forecasts</td><td>The search forecasts. </td></tr>
    <tr><td class="paramname">sims</td><td>A <a class="el" href="class_similarity_matrices.html" title="SimilarityMatrices class stores similarity metrics. Default dimensions of SimilarityMatrices are: [te...">SimilarityMatrices</a>. </td></tr>
    <tr><td class="paramname">sds</td><td>A <a class="el" href="class_standard_deviation.html" title="StandardDeviation class is designed for storing the standard deviation of a Forecasts object...">StandardDeviation</a>. </td></tr>
    <tr><td class="paramname">weights</td><td>A vector of weights for each parameter in the forecasts. </td></tr>
    <tr><td class="paramname">flts_window</td><td>A matrix specifying the time window for each FLT. </td></tr>
    <tr><td class="paramname">circular_flags</td><td>A vector of boolean for whether a parameter is circular or not. </td></tr>
    <tr><td class="paramname">i_test_station</td><td>The index of the test station in test forecasts. </td></tr>
    <tr><td class="paramname">i_test_time</td><td>The index of the test time in test forecasts. </td></tr>
    <tr><td class="paramname">i_search_station</td><td>The index of search station in search forecasts. </td></tr>
    <tr><td class="paramname">i_search_time</td><td>The index of search time in search forecasts. </td></tr>
    <tr><td class="paramname">i_flt</td><td>The index of FLT of both the search and test forecasts. </td></tr>
    <tr><td class="paramname">max_par_nan</td><td>The maximum number of NAN allowed in parameters. </td></tr>
    <tr><td class="paramname">max_flt_nan</td><td>The maximum number of NAN allowed in the FLT window. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A similarity metric value. </dd></dl>

</div>
</div>
<a id="ad8be9b16b5e5e1cf30f61b4ecac2faee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8be9b16b5e5e1cf30f61b4ecac2faee">&#9670;&nbsp;</a></span>computeSearchStations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a> AnEn::computeSearchStations </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;&#160;</td>
          <td class="paramname"><em>test_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;&#160;</td>
          <td class="paramname"><em>search_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">AnEn::SearchStationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>i_search_stations_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_num_search_stations</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>distance</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nearest_stations</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the search stations of each test stations. Search stations are represented using the their index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test_stations</td><td>Test <a class="el" href="classanen_sta_1_1_stations.html" title="Stations class stores Station objects. ">anenSta::Stations</a>. </td></tr>
    <tr><td class="paramname">search_stations</td><td>Search <a class="el" href="classanen_sta_1_1_stations.html" title="Stations class stores Station objects. ">anenSta::Stations</a>. </td></tr>
    <tr><td class="paramname">i_search_stations</td><td>A matrix to store the search stations for each test stations per row. </td></tr>
    <tr><td class="paramname">max_num_search_stations</td><td>The maximum number of search stations that will be stored. </td></tr>
    <tr><td class="paramname">distance</td><td>The buffer distance from each test station to look for search stations. </td></tr>
    <tr><td class="paramname">num_nearest_stations</td><td>The number of KNN search stations to look for for each test stations. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An errorType; </dd></dl>

</div>
</div>
<a id="ad032b4a80d86c6c31ef26a3eb381cb5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad032b4a80d86c6c31ef26a3eb381cb5d">&#9670;&nbsp;</a></span>computeSimilarity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a> AnEn::computeSimilarity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;&#160;</td>
          <td class="paramname"><em>test_forecasts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_forecasts__array.html">Forecasts_array</a> &amp;&#160;</td>
          <td class="paramname"><em>search_forecasts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_standard_deviation.html">StandardDeviation</a> &amp;&#160;</td>
          <td class="paramname"><em>sds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_similarity_matrices.html">SimilarityMatrices</a> &amp;&#160;</td>
          <td class="paramname"><em>sims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_observations__array.html">Observations_array</a> &amp;&#160;</td>
          <td class="paramname"><em>search_observations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_an_en.html#adc55d358a20ee6bb711ca5efb33a1bb0">SearchStationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>i_search_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_observation_parameter</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>extend_observations</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_par_nan</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_flt_nan</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a>&#160;</td>
          <td class="paramname"><em>test_times</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a>&#160;</td>
          <td class="paramname"><em>search_times</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>operational</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the similarity matrices.</p>
<p>If a particular value is NAN, you can inspect the reason for this value being NAN by looking at the time index column. The value can be any one from the following list:</p><ul>
<li>-1: Cannot find the corresponding observation time. Mapping entry is NAN.</li>
<li>-2: Search forecast excluded because it overlaps with the current test foreacst.</li>
<li>NAN: Noun of the above. This can be caused by a numebr of reaons: 1) the search station is NAN; 2) The observation associated with this historical forecast is NAN; 3) too many NAN parameters when computing the similarity and averaging across FLTs and multiple parameters.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test_forecasts</td><td><a class="el" href="class_forecasts.html" title="Forecasts class provides interface for reading and writing forecast data from and to a NetCDF file...">Forecasts</a> to test. </td></tr>
    <tr><td class="paramname">search_forecasts</td><td><a class="el" href="class_forecasts.html" title="Forecasts class provides interface for reading and writing forecast data from and to a NetCDF file...">Forecasts</a> to search. </td></tr>
    <tr><td class="paramname">sds</td><td>Pre-computed standard deviation of the forecasts to search. This can be computed from the function AnEn::computeStandardDeviation; </td></tr>
    <tr><td class="paramname">sims</td><td>A <a class="el" href="class_similarity_matrices.html" title="SimilarityMatrices class stores similarity metrics. Default dimensions of SimilarityMatrices are: [te...">SimilarityMatrices</a>. </td></tr>
    <tr><td class="paramname">search_observations</td><td><a class="el" href="class_observations.html" title="Observations class provides interface for reading and writing observations from and to a NetCDF file...">Observations</a> to search. </td></tr>
    <tr><td class="paramname">mapping</td><td>A matrix stores the mapping indices from forecasts times and FLTs to observation times. </td></tr>
    <tr><td class="paramname">i_search_stations</td><td>A precomputed matrix with the search stations for each test station stored per row. </td></tr>
    <tr><td class="paramname">i_observation_parameter</td><td>The parameter in observations that will be checked for NAN values. By default it is 0 pointing at the first parameter. </td></tr>
    <tr><td class="paramname">extend_observations</td><td>Whether to extend observation stations to search stations. This only works when search space extension is used. </td></tr>
    <tr><td class="paramname">max_par_nan</td><td>The number of NAN values allowed when computing similarity across different parameters. Set it to NAN to allow any number of NAN values. </td></tr>
    <tr><td class="paramname">max_flt_nan</td><td>The number of NAN values allowed when computing FLT window averages. Set it to NAN to allow any number of NAN values. </td></tr>
    <tr><td class="paramname">operational</td><td>Whether to use operational search.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An errorType. </dd></dl>

</div>
</div>
<a id="afbccb0a25e09ef2353d0f754afe7273e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbccb0a25e09ef2353d0f754afe7273e">&#9670;&nbsp;</a></span>find_nearest_station_match_()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a> AnEn::find_nearest_station_match_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;&#160;</td>
          <td class="paramname"><em>test_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;&#160;</td>
          <td class="paramname"><em>search_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>test_stations_index_in_search</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function is a special case of <a class="el" href="class_an_en.html#ad8be9b16b5e5e1cf30f61b4ecac2faee">AnEn::computeSearchStations</a>. It finds the nearest search station to a specific test station. If location information is not provided, test and search stations are assumed to be the same, and they are matched based on their respective index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test_stations</td><td>Test <a class="el" href="classanen_sta_1_1_stations.html" title="Stations class stores Station objects. ">anenSta::Stations</a>. </td></tr>
    <tr><td class="paramname">search_stations</td><td>Search <a class="el" href="classanen_sta_1_1_stations.html" title="Stations class stores Station objects. ">anenSta::Stations</a>. </td></tr>
    <tr><td class="paramname">test_stations_index_in_search</td><td>A size_t vector to store the matching search indices for each test station.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An errorType. </dd></dl>

</div>
</div>
<a id="a97bc8ce00b972749d4e4cbfbf4bf45b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97bc8ce00b972749d4e4cbfbf4bf45b5">&#9670;&nbsp;</a></span>generateOperationalSearchTimes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a> AnEn::generateOperationalSearchTimes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> &amp;&#160;</td>
          <td class="paramname"><em>test_times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> &amp;&#160;</td>
          <td class="paramname"><em>search_times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classanen_time_1_1_times.html">anenTime::Times</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>search_times_operational</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>i_search_times_operational</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_flt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates the search times and the corresponding index with an operational mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">test_times</td><td>The test <a class="el" href="classanen_time_1_1_times.html" title="Times class is used to store time information for predictions. By default this is the number of secon...">anenTime::Times</a>; </td></tr>
    <tr><td class="paramname">search_times</td><td>The complete search <a class="el" href="classanen_time_1_1_times.html" title="Times class is used to store time information for predictions. By default this is the number of secon...">anenTime::Times</a>; </td></tr>
    <tr><td class="paramname">search_times_operational</td><td>The search <a class="el" href="classanen_time_1_1_times.html" title="Times class is used to store time information for predictions. By default this is the number of secon...">anenTime::Times</a> for operational mode. </td></tr>
    <tr><td class="paramname">i_search_times_operational</td><td>The index for search <a class="el" href="classanen_time_1_1_times.html" title="Times class is used to store time information for predictions. By default this is the number of secon...">anenTime::Times</a> for operational mode. </td></tr>
    <tr><td class="paramname">max_flt</td><td>The maximum FLT. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An errorType. </dd></dl>

</div>
</div>
<a id="a5e703c85514bb4768278bebe20fe4642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e703c85514bb4768278bebe20fe4642">&#9670;&nbsp;</a></span>getMethod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a> AnEn::getMethod </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa937a792202a83e88df6e019a991b848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa937a792202a83e88df6e019a991b848">&#9670;&nbsp;</a></span>getVerbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AnEn::getVerbose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e2b88cda5cc9fce8ea4703a3236719c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e2b88cda5cc9fce8ea4703a3236719c">&#9670;&nbsp;</a></span>selectAnalogs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_type_8h.html#a0455f547a8d97c35c868b184e0c92ffd">errorType</a> AnEn::selectAnalogs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_analogs.html">Analogs</a> &amp;&#160;</td>
          <td class="paramname"><em>analogs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_similarity_matrices.html">SimilarityMatrices</a> &amp;&#160;</td>
          <td class="paramname"><em>sims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classanen_sta_1_1_stations.html">anenSta::Stations</a> &amp;&#160;</td>
          <td class="paramname"><em>test_stations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_observations__array.html">Observations_array</a> &amp;&#160;</td>
          <td class="paramname"><em>search_observations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_an_en.html#a44ceab50f0bf394bd35871469d5a36b2">TimeMapMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_members</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quick</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>extend_observations</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Select analogs based on the similarity matrices.</p>
<p>If a particular value is NAN, you can inspect the reason for this value being NAN by looking at the time index column. The value can be any one from the following list:</p><ul>
<li>-1: Cannot find the corresponding observation time. Mapping entry is NAN.</li>
<li>-2: Similarity is NAN.</li>
<li>-3: Number of members is larger than number of similarity entries.</li>
<li>NAN: Unknown reason.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">analogs</td><td><a class="el" href="class_analogs.html" title="This is the class to store analogs. The default dimensions are: [test stations][test times][FLTs][mem...">Analogs</a> object to write the analogs </td></tr>
    <tr><td class="paramname">sims</td><td><a class="el" href="class_similarity_matrices.html" title="SimilarityMatrices class stores similarity metrics. Default dimensions of SimilarityMatrices are: [te...">SimilarityMatrices</a> on which the selection is based </td></tr>
    <tr><td class="paramname">test_stations</td><td><a class="el" href="classanen_sta_1_1_stations.html" title="Stations class stores Station objects. ">anenSta::Stations</a> for the test. </td></tr>
    <tr><td class="paramname">search_observations</td><td><a class="el" href="class_observations__array.html" title="Observations_array class is an implementation of the class Observations. Data are stored using the bo...">Observations_array</a> where the analog values come from. </td></tr>
    <tr><td class="paramname">mapping</td><td>A Boost Matrix for the mapping of times between forecasts and observations. This is computed from the function AnEn::computeObservationsTimeIndices. </td></tr>
    <tr><td class="paramname">i_parameter</td><td>The index of the parameter to select in <a class="el" href="class_observations.html" title="Observations class provides interface for reading and writing observations from and to a NetCDF file...">Observations</a>. </td></tr>
    <tr><td class="paramname">num_members</td><td>How many members each analog should have. </td></tr>
    <tr><td class="paramname">quick</td><td>Whether to use quick sort mechanism. </td></tr>
    <tr><td class="paramname">extend_observations</td><td>Whether to extend observation stations to search stations. This only works when search space extension is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An errorType. </dd></dl>

</div>
</div>
<a id="afd6b6018f1ca8b138af2aaafe5464cbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd6b6018f1ca8b138af2aaafe5464cbd">&#9670;&nbsp;</a></span>setMethod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnEn::setMethod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af1009201b008da7395f1c1ed0ec287cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1009201b008da7395f1c1ed0ec287cd">&#9670;&nbsp;</a></span>setVerbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnEn::setVerbose </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a085c41c286923d751230f4abf2985292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a085c41c286923d751230f4abf2985292">&#9670;&nbsp;</a></span>_FILL_VALUE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double AnEn::_FILL_VALUE = NAN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The default fill value for analogs. </p>

</div>
</div>
<a id="a15e0444046a071247082296d78ed5aa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15e0444046a071247082296d78ed5aa3">&#9670;&nbsp;</a></span>_SERIAL_LENGTH_LIMIT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const size_t AnEn::_SERIAL_LENGTH_LIMIT = 500</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The upper limit for running program serially. If the length is larger than the limit, it will be parallelized. </p>

</div>
</div>
<a id="a3c503cbae77244126d1616e90a07c92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c503cbae77244126d1616e90a07c92f">&#9670;&nbsp;</a></span>method_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62a">simMethod</a> AnEn::method_ = <a class="el" href="class_an_en.html#a94dd770690ca98baca9c2a62a36bc62aa951dc29c260676ddba508790abfdb2d0">OneToOne</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a25984b953516a987e2e9eb23048e5d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25984b953516a987e2e9eb23048e5d60">&#9670;&nbsp;</a></span>verbose_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int AnEn::verbose_ = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Specifies the verbose level.</p><ul>
<li>0: Quiet.</li>
<li>1: Errors.</li>
<li>2: The above plus Warnings.</li>
<li>3: The above plus program progress information.</li>
<li>4: The above plus check information.</li>
<li>5: The above plus session information. </li>
</ul>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/graduate/wuh20/github/AnalogsEnsemble/CAnEn/include/<a class="el" href="_an_en_8h_source.html">AnEn.h</a></li>
<li>/home/graduate/wuh20/github/AnalogsEnsemble/CAnEn/src/<a class="el" href="_an_en_8cpp.html">AnEn.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
